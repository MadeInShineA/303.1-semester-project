[
  {
    "objectID": "src/sources.html",
    "href": "src/sources.html",
    "title": "Sources",
    "section": "",
    "text": "DIPY website\nDIPY contributing guide\nDIPY developer guide\nTutorials\n\nReconstruct with Constant Solid Angle (Q-Ball)\nReconstruct with Generalized Q-Sampling Imaging\nIntroduction to Basic Tracking"
  },
  {
    "objectID": "src/sources.html#dipy",
    "href": "src/sources.html#dipy",
    "title": "Sources",
    "section": "",
    "text": "DIPY website\nDIPY contributing guide\nDIPY developer guide\nTutorials\n\nReconstruct with Constant Solid Angle (Q-Ball)\nReconstruct with Generalized Q-Sampling Imaging\nIntroduction to Basic Tracking"
  },
  {
    "objectID": "src/sources.html#youtube-videos",
    "href": "src/sources.html#youtube-videos",
    "title": "Sources",
    "section": "Youtube videos",
    "text": "Youtube videos\n\nDiffusion Weighted Imaging - Doctor Klioze\nDiffusion Tensor Imaging (DTI) - Doctor Klioze\nDiffusion Tensor Imaging (DTI) Explained! | Neuroscience Methods 101 - Psyched!\nDWI vs ADC MRI sequences: EXPLAINED - Radiology Tutorials\nDiffusion Weighted Imaging EXPLAINED (DWI Trace, ADC, B-Values) | MRI Physics Course Lecture 14 - MRI Physics EXPLAINED\nHow to Read MRI Diffusion Imaging (DWI) like a Real Radiologist - MRI Physics EXPLAINED"
  },
  {
    "objectID": "src/sources.html#other",
    "href": "src/sources.html#other",
    "title": "Sources",
    "section": "Other",
    "text": "Other\n\nNipreps book\nProf. Esteban DIPY pull request\nProf. Esteban DIPY fork\nMarimo website\nQuarto website"
  },
  {
    "objectID": "src/index.html",
    "href": "src/index.html",
    "title": "303.1 Semester Project:Extending DIPY’s Generalized Q-ball Imaging model to make predictions",
    "section": "",
    "text": "This project is part of the 303.1 semester project course.\nThe goal is to contribute to the DIPY framework by extending the Generalized Q-ball Imaging (GQI) model with predictive capabilities.\nThe key objectives are:\n\nImplementing a predict() function to the GeneralizedQSamplingFit class\nThoroughly documenting the new code\nProviding comprehensive and meaningful tests\nGetting the prediction pull request accepted by DIPY"
  },
  {
    "objectID": "src/index.html#project-overview",
    "href": "src/index.html#project-overview",
    "title": "303.1 Semester Project:Extending DIPY’s Generalized Q-ball Imaging model to make predictions",
    "section": "",
    "text": "This project is part of the 303.1 semester project course.\nThe goal is to contribute to the DIPY framework by extending the Generalized Q-ball Imaging (GQI) model with predictive capabilities.\nThe key objectives are:\n\nImplementing a predict() function to the GeneralizedQSamplingFit class\nThoroughly documenting the new code\nProviding comprehensive and meaningful tests\nGetting the prediction pull request accepted by DIPY"
  },
  {
    "objectID": "src/index.html#project-gantt-diagram",
    "href": "src/index.html#project-gantt-diagram",
    "title": "303.1 Semester Project:Extending DIPY’s Generalized Q-ball Imaging model to make predictions",
    "section": "Project Gantt Diagram",
    "text": "Project Gantt Diagram\n\n\n\n\n\n\ngantt\n\n    title Semester Project Gantt Diagram\n    dateFormat DD.MM.YYYY\n    axisFormat %d.%m\n\n    section Background\n        Literature review (DWI, GQI, MRI)       :done,         research,       24.11.2025, 2d\n        Study Nipreps book (DWI preprocessing)  :done,         nipreps,        24.11.2025, 3d\n\n    section Development\n        Dev environment setup                   :done,         devenv,         25.11.2025, 1d\n        Study GQI codebase                      :done,         codebase,       25.11.2025, 3d\n        Create baseline prediction tests        :done,         simple_tests,   26.11.2025, 2d\n        Develop Marimo validation notebooks     :done,         notebooks,      26.11.2025, 2d\n        Implement case 2 voxel prediction test :done,         cross_tests,    01.12.2025, 2d\n        Create unseen data prediction notebook  :active,       unseen_data,    03.12.2025, 2d\n        Add the GQI predict example to dipy doc :              predict_example,04.12.2025, 08.12.2025\n\n      \n        \n\n    section Milestones & &lt;br&gt;Deliverables\n        Prof. Esteban – Kickoff meeting         :done,         milestone,      25.11.2025, 0d\n        Prof. Esteban – Progress check-in       :done,         milestone,      27.11.2025, 0d\n        Create Gantt diagram                    :done,         gantt,          28.11.2025, 1d\n        Design impact slide                     :done,         impact,         28.11.2025, 1d\n        Draft report outline                    :done,         r_draft,        01.12.2025, 1d\n        Prof. Esteban - Second progress check-in:done,         milestone,      03.12.2025, 0d\n        Create presentation dwi slide           :              p_draft,        06.12.2025, 08.12.2025 \n        Prof. Esteban - Third progress check-in :              milestone,      08.12.2025, 0d\n        Code and documentation handout          :              milestone,      16.12.2025, 0d\n        Final presentation                      :              milestone,      18.12.2025, 0d"
  },
  {
    "objectID": "src/index.html#documents",
    "href": "src/index.html#documents",
    "title": "303.1 Semester Project:Extending DIPY’s Generalized Q-ball Imaging model to make predictions",
    "section": "Documents",
    "text": "Documents\n\nReport: Detailed technical documentation and results\nPresentation: Slide deck summarizing the project\nDaily Diary: Development log and progress updates\nSources: Bibliography and references"
  },
  {
    "objectID": "src/report.html",
    "href": "src/report.html",
    "title": "Implementation Report: Predict Function",
    "section": "",
    "text": "This report provides an overview of the implemented prediction functions in DIPY’s Generalized Q-Sampling Imaging (GQI) model, covering their purpose, operational mechanics, mathematical foundations, testing methodology, capabilities, and future directions.\nKey topics include:\n\nFunctionality and operation of the GQI prediction functions (gqi_kernel, prediction_kernel, and predict)\nMathematical derivations and pseudo-inverse computations\nTesting procedures applied to the functions\nEnabled applications and subsequent development steps"
  },
  {
    "objectID": "src/report.html#introduction",
    "href": "src/report.html#introduction",
    "title": "Implementation Report: Predict Function",
    "section": "",
    "text": "This report provides an overview of the implemented prediction functions in DIPY’s Generalized Q-Sampling Imaging (GQI) model, covering their purpose, operational mechanics, mathematical foundations, testing methodology, capabilities, and future directions.\nKey topics include:\n\nFunctionality and operation of the GQI prediction functions (gqi_kernel, prediction_kernel, and predict)\nMathematical derivations and pseudo-inverse computations\nTesting procedures applied to the functions\nEnabled applications and subsequent development steps"
  },
  {
    "objectID": "src/report.html#the-different-needed-helper-functions",
    "href": "src/report.html#the-different-needed-helper-functions",
    "title": "Implementation Report: Predict Function",
    "section": "2 The different needed helper functions",
    "text": "2 The different needed helper functions\nThe predict function implementation relies on two key helper functions:\n\ngqi_kernel for kernel computation\nprediction_kernel for pseudo-inverse calculation.\n\nIn this section, each function is described in detail, including its purpose, parameters, and role in signal reconstruction from ODFs.\n\n2.1 The gqi_kernel function\nThe gqi_kernel function calculates the Generalized Q-Sampling Imaging (GQI) transformation kernel, which is essential for modeling diffusion signals in terms of orientation distribution functions (ODFs). This kernel transforms gradient directions and b-values into a matrix that relates diffusion signals to ODFs on a spherical grid.\n\nPurpose: Computes the kernel matrix for GQI-based signal reconstruction. It handles different GQI methods (e.g., “standard” or “gqi2”) and incorporates physical constants like the free water diffusion coefficient.\nKey Parameters:\n\ngtab: GradientTable containing b-values and b-vectors.\nparam_lambda: Regularization parameter for the kernel.\nsphere: Spherical grid for ODF sampling.\nmethod: Specifies the GQI variant (“standard” by default).\n\nOperation: Scales b-vectors by a diffusion-related factor, computes dot products with sphere vertices, and applies sinc or squared radial functions to generate the kernel.\n\ndef gqi_kernel(gtab, param_lambda, sphere, method=\"standard\"):\n    # 0.01506 = 6*D where D is the free water diffusion coefficient\n    # l_values sqrt(6 D tau) D free water diffusion coefficient and\n    # tau included in the b-value\n    scaling = np.sqrt(gtab.bvals * 0.01506)\n    b_vector = gtab.bvecs * scaling[:, None]\n\n    if method == \"gqi2\":\n        H = squared_radial_component\n        return np.real(H(np.dot(b_vector, sphere.vertices.T) * param_lambda))\n    elif method != \"standard\":\n        warnings.warn(\n            f'GQI model \"{method}\" unknown, falling back to \"standard\".',\n            stacklevel=1,\n        )\n    return np.real(np.sinc(np.dot(b_vector, sphere.vertices.T) * param_lambda / np.pi))\nMathematically, the GQI kernel \\(K\\) is computed as:\nFor the “standard” method: \\[\nK_{ij} = \\frac{\\sin\\left( \\lambda (\\mathbf{q}_i \\cdot \\mathbf{v}_j) \\right)}{\\lambda (\\mathbf{q}_i \\cdot \\mathbf{v}_j)} = \\operatorname{sinc}\\left( \\frac{\\lambda (\\mathbf{q}_i \\cdot \\mathbf{v}_j)}{\\pi} \\right)\n\\] Where:\n\n\\(\\mathbf{q}_i = \\mathbf{g}_i \\sqrt{b_i \\cdot 0.01506}\\) (scaled gradient)\n\\(\\mathbf{v}_j\\) are sphere vertices\n\\(\\lambda\\) is the regularization parameter\n\\(\\operatorname{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}\\) is the NumPy’s normalized sinc function.\n\nFor the “gqi2” method: \\[\nK_{ij} = \\operatorname{Re}\\left[ H\\left( \\lambda (\\mathbf{q}_i \\cdot \\mathbf{v}_j) \\right) \\right]\n\\] Where \\(H\\) is the squared radial component function.\n\n\n2.2 The prediction_kernel function\nThe prediction_kernel function computes the Moore-Penrose pseudo-inverse of the GQI kernel, enabling signal reconstruction from orientation distribution functions (ODFs) in the DIPY convention.\n\nPurpose: Generates the pseudo-inverse kernel for solving S from \\(ODF = S \\cdot K\\), using regularization for numerical stability.\nKey Parameters:\n\ngtab: GradientTable for the prediction.\nparam_lambda: Regularization parameter.\nsphere: Spherical grid.\nmethod: GQI method.\n\nOperation: Computes the GQI kernel K, forms K.T @ K, adds regularization, inverts the matrix, and multiplies by K.T to produce the Moore-Penrose pseudo-inverse kernel.\n\ndef prediction_kernel(gtab, param_lambda, sphere, method=\"standard\"):\n    # K.shape = (n_gradients, n_vertices)\n    INVERSE_LAMBDA = 1e-6\n    K = gqi_kernel(gtab, param_lambda, sphere, method=method)\n    GtG = K.T @ K\n    identity = np.eye(GtG.shape[0])\n    return np.linalg.inv(GtG + INVERSE_LAMBDA * identity) @ K.T\nMathematically, the prediction kernel \\(K^{+}\\) (the pseudo-inverse) is computed as: \\[\nK^{+} = (K^T K + \\lambda I)^{-1} K^T\n\\] Where:\n\n\\(K\\) is the GQI kernel from gqi_kernel\n\\(\\lambda\\) is the regularization parameter (INVERSE_LAMBDA)\n\\(I\\) is the identity matrix."
  },
  {
    "objectID": "src/report.html#the-predict-function-and-its-implementation",
    "href": "src/report.html#the-predict-function-and-its-implementation",
    "title": "Implementation Report: Predict Function",
    "section": "3 The predict function and it’s implementation",
    "text": "3 The predict function and it’s implementation\nThe target predicted signal is given by the following relationship \\[\n   \\begin{alignat*}{2}\n             &ODF                      &&= S \\cdot K \\\\\n  \\iff\\quad & ODF \\cdot K^{+}          &&\\approx S \\cdot K \\cdot K^{+} \\\\\n  \\iff\\quad & ODF \\cdot K^{+}          &&\\approx S \\\\\n  \\iff\\quad & S                        &&\\approx ODF \\cdot K^{+}\n  \\end{alignat*}\n  \\]\nWhere \\(K^{+}\\) is the Moore-Penrose pseudo inverse of the GQI kernel \\(K\\).\nNote that the Moore-Penrose pseudo inverse is needed since the GQI kernel \\(K\\)’s dimensions are \\((n_\\mathrm{gradients}, n_\\mathrm{vertices})\\), which means it’s (most of the time) not a square matrix and therefore not having a true inverse.\nThe predict function reconstructs diffusion signals from the fitted signal data by first computing the ODF internally and then applying the pseudo inverse kernel.\n\nPurpose: Predicts diffusion-weighted signals from fitted data, supporting both single-voxel and multi-voxel data.\nKey Parameters:\n\ngtab: GradientTable for which to predict signals.\nS0: Optional baseline signal (not used in this implementation).\n\nOperation: Computes \\(ODF = model.kernel \\cdot data\\), then predicted = \\(ODF \\cdot K^{+}\\) where \\(K^{+}\\) is provided by prediction_kernel. Handles data reshaping for matrix operations and ensures non-negative outputs by clamping values.\n\ndef predict(self, gtab, *, S0=None):\n  K_plus = prediction_kernel(\n    gtab,\n    self.model.Lambda,\n    self.model.sphere,\n    self.model.method,\n  )\n\n  # Handle both 1D (single voxel) and multi-dimensional data\n  if self.data.ndim == 1:\n    # Single voxel case\n    ODF = self.model.kernel @ self.data\n    predicted = ODF @ K_plus\n  else:\n    # Multi-voxel case - reshape for matrix multiplication\n    original_shape = self.data.shape\n    data_2d = self.data.reshape(-1, original_shape[-1])\n    ODF_2d = self.model.kernel @ data_2d.T  # shape (n_vertices, n_voxels)\n    predicted_2d = ODF_2d.T @ K_plus  # shape (n_voxels, n_gradients)\n    predicted = predicted_2d.reshape(original_shape[:-1] + (K_plus.shape[1],))\n\n  # Clamp to non-negative values\n  return np.maximum(predicted, 0)\nMathematically, the predicted signal \\(\\mathbf{S}_\\mathrm{pred}\\) is computed as: \\[\n\\mathbf{S}_\\mathrm{pred} = \\max(0, \\mathrm{ODF} \\cdot K^{+})\n\\] Where:\n\n\\(\\mathrm{ODF} = K_\\mathrm{model} \\cdot \\mathbf{S}_\\mathrm{data}\\) is the ODF computed from the fitted signal data\n\\(K^{+}\\) is the pseudo-inverse kernel from prediction_kernel\n\nThe max operation ensures non-negative signal values."
  },
  {
    "objectID": "src/report.html#testing-methodology",
    "href": "src/report.html#testing-methodology",
    "title": "Implementation Report: Predict Function",
    "section": "4 Testing Methodology",
    "text": "4 Testing Methodology\n\n4.1 Round trip testing\n\n\n4.2 Cross validation testing"
  },
  {
    "objectID": "src/report.html#capabilities-and-applications",
    "href": "src/report.html#capabilities-and-applications",
    "title": "Implementation Report: Predict Function",
    "section": "5 Capabilities and Applications",
    "text": "5 Capabilities and Applications"
  },
  {
    "objectID": "src/report.html#future-directions",
    "href": "src/report.html#future-directions",
    "title": "Implementation Report: Predict Function",
    "section": "6 Future Directions",
    "text": "6 Future Directions"
  },
  {
    "objectID": "src/report.html#conclusion",
    "href": "src/report.html#conclusion",
    "title": "Implementation Report: Predict Function",
    "section": "7 Conclusion",
    "text": "7 Conclusion"
  },
  {
    "objectID": "src/report.html#resources",
    "href": "src/report.html#resources",
    "title": "Implementation Report: Predict Function",
    "section": "8 Resources",
    "text": "8 Resources\n\n8.1 DIPY tutorial repository notebooks\n\nReconstruct with Constant Solid Angle (Q-Ball)\nReconstruct with Generalized Q-Sampling Imaging\nIntroduction to Basic Tracking\n\n\n\n8.2 DIPY repository notebooks\n\nGQI Roundtrip\nGQI Cross Voxel"
  },
  {
    "objectID": "src/daily_diary.html",
    "href": "src/daily_diary.html",
    "title": "Daily diary",
    "section": "",
    "text": "Made a pull request to the Nipreps book repo\nRealised the different DIPY tutorials\nStarted reading the Nipreps book"
  },
  {
    "objectID": "src/daily_diary.html#section",
    "href": "src/daily_diary.html#section",
    "title": "Daily diary",
    "section": "",
    "text": "Made a pull request to the Nipreps book repo\nRealised the different DIPY tutorials\nStarted reading the Nipreps book"
  },
  {
    "objectID": "src/daily_diary.html#section-1",
    "href": "src/daily_diary.html#section-1",
    "title": "Daily diary",
    "section": "25.11.2025",
    "text": "25.11.2025\n\nMeeting with Prof. Esteban\nPrepared the DIPY development environment\n\nInstallation steps\n\nCreate a venv and source it (or use uv venv and uv pip …)\nTo build the project\n\nsudo dnf install python3-devel\npip install -r requirements/build.txt\npip install –no-build-isolation -e .\n\nTo build the documentation\n\npip install sphinx\npip install sphinx_gallery\npip install numpydoc\npip install sphinxcontrib-bibtex\npip install sphinx-design\npip install grg-sphinx-theme\n\nTo use the correct formatting\n\npip install –no-build-isolation -e .[style]\npip install pre-commit\npre-commit install\n\n\n\nStarted to look at the current gqi predict code and pull request\nContinued reading the Nipreps book (tried to fix a latex rendering error unsuccessfully)"
  },
  {
    "objectID": "src/daily_diary.html#section-2",
    "href": "src/daily_diary.html#section-2",
    "title": "Daily diary",
    "section": "26.11.2025",
    "text": "26.11.2025\n\nFinished reading the Nipreps book\nContinued to look at the current gqi code and made small changes on the enh/gqi-predict-dev branch\n\nChanged GeneralizedQSamplingFit odf function to take a sphere parameter (see commit)\nChanged the GeneralizedQSamplingFit predict function to use clamping to remove negative value predictions (see commit)\n\nCreated a small marimo notebook to test and understand the prediction function on the enh/gqi-predict-notebooks branch (see commit)"
  },
  {
    "objectID": "src/daily_diary.html#section-3",
    "href": "src/daily_diary.html#section-3",
    "title": "Daily diary",
    "section": "27.11.2025",
    "text": "27.11.2025\n\nChanged the GeneralizedQSamplingFit predict function to use the model mode when calling the predict_kernel function. Also made the predict function work for multi-voxels (see commit)\nStarted gqi predict tests with (see commit)\n\nSingle-voxel basic test\nSingle-voxel meaningful test\nMulti-voxel basic test\nMulti-voxel meaningful test\n\nMeeting with Prof. Esteban\nDid 2 marimo notebooks on the enh/gqi-predict-notebooks branch (see commit)\n\nA notebook regarding the roundtrip predictions on already seen data (see notebook)\nA notebook regarding cross voxel predictions (see notebook)\n\nCreated the 303.1-semester-project github page (see page)"
  },
  {
    "objectID": "src/daily_diary.html#section-4",
    "href": "src/daily_diary.html#section-4",
    "title": "Daily diary",
    "section": "28.11.2025",
    "text": "28.11.2025\n\nCreated the Gantt diagram\nCreated the presentation github repository(now removed)\nStarted the presentation\nPublished the presentation github page (see page)"
  },
  {
    "objectID": "src/daily_diary.html#section-5",
    "href": "src/daily_diary.html#section-5",
    "title": "Daily diary",
    "section": "01.12.2025",
    "text": "01.12.2025\n\nStarted working on the cross validation prediction test\nWorked on the project documentation (see documentation)\n\nAdded a quarto theme\nAdded sources + daily diary pages\nAdded mermaid Gantt diagram\nWorked on the report structure (see report)"
  },
  {
    "objectID": "src/daily_diary.html#section-6",
    "href": "src/daily_diary.html#section-6",
    "title": "Daily diary",
    "section": "02.12.2025",
    "text": "02.12.2025\n\nAdded unseen data prediction tests + Cleaned gqi predict functions and existing tests (see commit)\nRefactored the gqi predict and prediction_kernel functions to work according to DIPY’s ODF formula:\n\\(ODF = S \\cdot K\\) (see commit)\nWrote the The different needed helper functions and The predict function and it’s implementation sections in the report (see commit)"
  },
  {
    "objectID": "src/daily_diary.html#section-7",
    "href": "src/daily_diary.html#section-7",
    "title": "Daily diary",
    "section": "03.12.2025",
    "text": "03.12.2025\n\nMeeting with Prof. Esteban"
  }
]