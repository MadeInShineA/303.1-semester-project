---
title: "303.1 Semester Project Presentation"
resources:
  - "./assets/presentation/dMRI-signal-movie.mp4"
format:
  revealjs:
    theme: [default, ./presentation.scss]
    center: true
    transition: fade
    incremental: false
    slide-number: true
    preview-links: auto
    navigation-mode: grid
    # auto-play-media: true
    footer: '<a href="./index.qmd" style="color: inherit; text-decoration: none;">Home</a> | <a href="./sources.qmd" style="color: inherit; text-decoration: none;">Sources</a> | 303.1 Semester Project Presentation © 2025'
bibliography: ./references.bib
---


# What Is DWI ?
:::: {.columns}

::: {.column width="60%"}
MRI technique that measures the diffusion of water molecules in biological tissues.

- **Principle**: Uses magnetic field gradients to sensitize the MRI signal to water diffusion
- **Key parameters**: 
  - b-values
  - b-vectors
:::

::: {.column width="40%"}


::: {#fig-cern}

{{< video ./assets/presentation/dMRI-signal-movie.mp4 >}}

Visual example of DWI, sourced from Dr. A. Rokem, DIPY workshop 2021

:::

:::

::::

# Why DWI ?
![[NDMG detailed pipeline](https://ndmg.neurodata.io/pipeline/diffusion){target="_blank"}](./assets/presentation/ndmg-d-detailed-pipeline.jpg){#fig-ndmg-pipeline}

# Project Goals

  - Contribute to [DIPY](https://dipy.org/){target="_blank"}
  - Add prediction capabilities to\
  the existing `GeneralizedQSamplingModel` class

# What Has Been Done
  - Enable prediction for the `GeneralizedQSamplingModel`
  - Rigorous Testing
    - Unit tests (100% coverage)
    - Integration tests via different [Marimo](htts://marimo.io){target=_blank} notebooks
  - Automated code documentation via [Sphinx](https://www.sphinx-doc.org/en/master/){target="_blank"}
  - Created a [DIPY tutorial document](./assets/examples/reconst_gqi_predict.html) on the prediction pipeline
  - Project documentation (see [homepage](./index.qmd){target="_blank"})
  - Ongoing [pull request](https://github.com/oesteban/dipy/pull/1){target="_blank"} on Prof.Estban DIPY [fork](https://github.com/oesteban/dipy){target="_blank"}
    - Currently being reviewed by the DIPY's team

# DIPY GQI Model Pipeline


```{dot}
//| label: fig-gqi-model-pipeline
//| fig-cap: "DIPY GQI model simplified pipeline, made with GraphViz"
//| fig-height: 200px
digraph GQI {
    rankdir=LR;
    node [shape=box, style=rounded, fontsize=10];
    
    DWI [label="DWI"];
    Model [label="model = GQIModel(bvals, bvecs, ...)"];
    Fit [label="model.fit(data)"];
    ODF [label="ODF"];
    
    DWI -> Model -> Fit -> ODF;
}
```

:::: {.columns}

::: {.column width="45%"}

![GQI model input image example,<br>from the `stanford_hardi` dataset[^1]](./assets/presentation/reconst-data.png){#fig-test1 height=200px}

:::
::: {.column width="10%"}

<div style="display: flex; align-items: center; justify-content: center; height: 200px;">→</div>

:::

::: {.column width="45%"}

![GQI model output example (ODF),<br>from the stanford_hardi dataset¹](./assets/presentation/reconst-odf.png){#fig-test2 height=200px}

:::

::::

[^1]: The `stanford_hardi` dataset is a high angular resolution diffusion imaging (HARDI) dataset from Stanford University,
consisting of 150 diffusion-weighted volumes.

# How Is The Signal Predicted ?

$$
\begin{alignat*}{2}
          &ODF                      &&= S \cdot K \\
\iff\quad & ODF \cdot K^{+}          &&\approx S \cdot K \cdot K^{+} \\
\iff\quad & ODF \cdot K^{+}          &&\approx S \\
\iff\quad & S                        &&\approx ODF \cdot K^{+}
\end{alignat*}
$$

Where:

 - $S$ is the GQI model fitted signal (or data)
 - $K^{+}$ is a regularized pseudo-inverse of the GQI kernel $K$.

# Testing Methodology

- Signal reconstruction based on seen data
  - To make sure that the `predict` function implementation works properly
- Signal prediction based on unseen data
  - To test the generalization of the `predict` function


# Testing Methodology: Reconstruction Tests

![Reconstruction pipeline schema, made with excalidraw](./assets/presentation/reconstructing_test_schema.svg){#fig-reconstruct-pipeline}

# Single-Voxel Reconstruction Results

![Voxel (0, 0, 0) Signal Reconstruction: Original vs Predicted based on the `small_101D` dataset[^2]](./assets/images/single_voxel_roundtrip_plot.png){#fig-single-voxel-results}

[^2]: The `small_101D` dataset is a small subset of diffusion spectrum imaging (DSI) data from DIPY, containing 101 diffusion-weighted volumes.

# Multi-Voxel Reconstruction Results

![Voxel-wise Reconstruction Accuracy based on the `small101D` dataset](./assets/images/multi_voxel_roundtrip_plot.png){#fig-multi-voxel-results}

# Testing Methodology: Unseen Prediction Test

![Unseen data prediction pipeline, made with excalidraw](./assets/presentation/predict_pipeline_schemas.svg){#fig-unseen-pipeline}

# Unseen Prediction Results

![Unseen data prediction results based on the `taiwan_ntu_dsi` dataset[^3]](./assets/images/unseen_data_plot.png){#fig-unseen-results}

[^3]: The `taiwan_ntu_dsi` dataset is a full DSI acquisition from the National Taiwan University, consisting of 515 diffusion-weighted volumes.

# Comparison Of<br>Reconstruction Vs Unseen Predictions

![Comparison of reconstruction vs unseen predictions based on the `taiwan_ntu_dsi` dataset](./assets/images/reconst_vs_unseen.png){#fig-reconstruction-vs-unseen}

# Impact

  - Head motion noise reduction (see @Amitay2012)
  - Meaningful data augmentation
  - Model cross validation 


# Conclusion
  - Great introduction to medical data science
  - Interesting to work on an established open source project
  - Useful bachelor thesis warm up

# Additional Resources

If you want more information about the project please visit this project website<br>[https://olivier.amacker.dev/303.1-semester-project/](./index.qmd){target="_blank"}

![Project website QR code](./assets/presentation/qrcode.png){#fig-qr}

# References

::: {#refs}
:::

